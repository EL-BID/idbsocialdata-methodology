var F=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function z(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var X={},B={};/*!
 * EventEmitter2
 * https://github.com/hij1nx/EventEmitter2
 *
 * Copyright (c) 2013 hij1nx
 * Licensed under the MIT license.
 */(function(t){(function(r){var s=Array.isArray?Array.isArray:function(u){return Object.prototype.toString.call(u)==="[object Array]"},h=10;function d(){this._events={},this._conf&&g.call(this,this._conf)}function g(i){i&&(this._conf=i,i.delimiter&&(this.delimiter=i.delimiter),i.maxListeners&&(this._events.maxListeners=i.maxListeners),i.wildcard&&(this.wildcard=i.wildcard),i.newListener&&(this.newListener=i.newListener),this.wildcard&&(this.listenerTree={}))}function m(i){this._events={},this.newListener=!1,g.call(this,i)}function v(i,u,a,l){if(!a)return[];var c=[],T,E,_,O,q,P,A,j=u.length,n=u[l],e=u[l+1];if(l===j&&a._listeners){if(typeof a._listeners=="function")return i&&i.push(a._listeners),[a];for(T=0,E=a._listeners.length;T<E;T++)i&&i.push(a._listeners[T]);return[a]}if(n==="*"||n==="**"||a[n]){if(n==="*"){for(_ in a)_!=="_listeners"&&a.hasOwnProperty(_)&&(c=c.concat(v(i,u,a[_],l+1)));return c}else if(n==="**"){A=l+1===j||l+2===j&&e==="*",A&&a._listeners&&(c=c.concat(v(i,u,a,j)));for(_ in a)_!=="_listeners"&&a.hasOwnProperty(_)&&(_==="*"||_==="**"?(a[_]._listeners&&!A&&(c=c.concat(v(i,u,a[_],j))),c=c.concat(v(i,u,a[_],l))):_===e?c=c.concat(v(i,u,a[_],l+2)):c=c.concat(v(i,u,a[_],l)));return c}c=c.concat(v(i,u,a[n],l+1))}if(O=a["*"],O&&v(i,u,O,l+1),q=a["**"],q)if(l<j){q._listeners&&v(i,u,q,j);for(_ in q)_!=="_listeners"&&q.hasOwnProperty(_)&&(_===e?v(i,u,q[_],l+2):_===n?v(i,u,q[_],l+1):(P={},P[_]=q[_],v(i,u,{"**":P},l+1)))}else q._listeners?v(i,u,q,j):q["*"]&&q["*"]._listeners&&v(i,u,q["*"],j);return c}function L(i,u){i=typeof i=="string"?i.split(this.delimiter):i.slice();for(var a=0,l=i.length;a+1<l;a++)if(i[a]==="**"&&i[a+1]==="**")return;for(var c=this.listenerTree,T=i.shift();T;){if(c[T]||(c[T]={}),c=c[T],i.length===0){if(!c._listeners)c._listeners=u;else if(typeof c._listeners=="function")c._listeners=[c._listeners,u];else if(s(c._listeners)&&(c._listeners.push(u),!c._listeners.warned)){var E=h;typeof this._events.maxListeners<"u"&&(E=this._events.maxListeners),E>0&&c._listeners.length>E&&(c._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",c._listeners.length),console.trace())}return!0}T=i.shift()}return!0}m.prototype.delimiter=".",m.prototype.setMaxListeners=function(i){this._events||d.call(this),this._events.maxListeners=i,this._conf||(this._conf={}),this._conf.maxListeners=i},m.prototype.event="",m.prototype.once=function(i,u){return this.many(i,1,u),this},m.prototype.many=function(i,u,a){var l=this;if(typeof a!="function")throw new Error("many only accepts instances of Function");function c(){--u===0&&l.off(i,c),a.apply(this,arguments)}return c._origin=a,this.on(i,c),l},m.prototype.emit=function(){this._events||d.call(this);var i=arguments[0];if(i==="newListener"&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var u=arguments.length,a=new Array(u-1),l=1;l<u;l++)a[l-1]=arguments[l];for(l=0,u=this._all.length;l<u;l++)this.event=i,this._all[l].apply(this,a)}if(i==="error"&&!this._all&&!this._events.error&&!(this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");var c;if(this.wildcard){c=[];var T=typeof i=="string"?i.split(this.delimiter):i.slice();v.call(this,c,T,this.listenerTree,0)}else c=this._events[i];if(typeof c=="function"){if(this.event=i,arguments.length===1)c.call(this);else if(arguments.length>1)switch(arguments.length){case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(var u=arguments.length,a=new Array(u-1),l=1;l<u;l++)a[l-1]=arguments[l];c.apply(this,a)}return!0}else if(c){for(var u=arguments.length,a=new Array(u-1),l=1;l<u;l++)a[l-1]=arguments[l];for(var E=c.slice(),l=0,u=E.length;l<u;l++)this.event=i,E[l].apply(this,a);return E.length>0||!!this._all}else return!!this._all},m.prototype.on=function(i,u){if(typeof i=="function")return this.onAny(i),this;if(typeof u!="function")throw new Error("on only accepts instances of Function");if(this._events||d.call(this),this.emit("newListener",i,u),this.wildcard)return L.call(this,i,u),this;if(!this._events[i])this._events[i]=u;else if(typeof this._events[i]=="function")this._events[i]=[this._events[i],u];else if(s(this._events[i])&&(this._events[i].push(u),!this._events[i].warned)){var a=h;typeof this._events.maxListeners<"u"&&(a=this._events.maxListeners),a>0&&this._events[i].length>a&&(this._events[i].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[i].length),console.trace())}return this},m.prototype.onAny=function(i){if(typeof i!="function")throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(i),this},m.prototype.addListener=m.prototype.on,m.prototype.off=function(i,u){if(typeof u!="function")throw new Error("removeListener only takes instances of Function");var a,l=[];if(this.wildcard){var c=typeof i=="string"?i.split(this.delimiter):i.slice();l=v.call(this,null,c,this.listenerTree,0)}else{if(!this._events[i])return this;a=this._events[i],l.push({_listeners:a})}for(var T=0;T<l.length;T++){var E=l[T];if(a=E._listeners,s(a)){for(var _=-1,O=0,q=a.length;O<q;O++)if(a[O]===u||a[O].listener&&a[O].listener===u||a[O]._origin&&a[O]._origin===u){_=O;break}if(_<0)continue;return this.wildcard?E._listeners.splice(_,1):this._events[i].splice(_,1),a.length===0&&(this.wildcard?delete E._listeners:delete this._events[i]),this}else(a===u||a.listener&&a.listener===u||a._origin&&a._origin===u)&&(this.wildcard?delete E._listeners:delete this._events[i])}return this},m.prototype.offAny=function(i){var u=0,a=0,l;if(i&&this._all&&this._all.length>0){for(l=this._all,u=0,a=l.length;u<a;u++)if(i===l[u])return l.splice(u,1),this}else this._all=[];return this},m.prototype.removeListener=m.prototype.off,m.prototype.removeAllListeners=function(i){if(arguments.length===0)return!this._events||d.call(this),this;if(this.wildcard)for(var u=typeof i=="string"?i.split(this.delimiter):i.slice(),a=v.call(this,null,u,this.listenerTree,0),l=0;l<a.length;l++){var c=a[l];c._listeners=null}else{if(!this._events[i])return this;this._events[i]=null}return this},m.prototype.listeners=function(i){if(this.wildcard){var u=[],a=typeof i=="string"?i.split(this.delimiter):i.slice();return v.call(this,u,a,this.listenerTree,0),u}return this._events||d.call(this),this._events[i]||(this._events[i]=[]),s(this._events[i])||(this._events[i]=[this._events[i]]),this._events[i]},m.prototype.listenersAny=function(){return this._all?this._all:[]},typeof r=="function"&&r.amd?r(function(){return m}):t.EventEmitter2=m})()})(B);var Q=k;function k(t){if(t)return G(t)}function G(t){for(var r in k.prototype)t[r]=k.prototype[r];return t}k.prototype.on=k.prototype.addEventListener=function(t,r){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(r),this};k.prototype.once=function(t,r){var s=this;this._callbacks=this._callbacks||{};function h(){s.off(t,h),r.apply(this,arguments)}return h.fn=r,this.on(t,h),this};k.prototype.off=k.prototype.removeListener=k.prototype.removeAllListeners=k.prototype.removeEventListener=function(t,r){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var s=this._callbacks[t];if(!s)return this;if(arguments.length==1)return delete this._callbacks[t],this;for(var h,d=0;d<s.length;d++)if(h=s[d],h===r||h.fn===r){s.splice(d,1);break}return this};k.prototype.emit=function(t){this._callbacks=this._callbacks||{};var r=[].slice.call(arguments,1),s=this._callbacks[t];if(s){s=s.slice(0);for(var h=0,d=s.length;h<d;++h)s[h].apply(this,r)}return this};k.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]};k.prototype.hasListeners=function(t){return!!this.listeners(t).length};var J=function(t,r,s){for(var h=0,d=t.length,g=arguments.length==3?s:t[h++];h<d;)g=r.call(null,g,t[h],++h,t);return g},U=Q,$=J,I=typeof window>"u"?F:window;function K(){}function V(t){var r={}.toString.call(t);switch(r){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}function W(){if(I.XMLHttpRequest&&(I.location.protocol!="file:"||!I.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch{}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch{}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch{}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch{}return!1}var Y="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};function R(t){return t===Object(t)}function M(t){if(!R(t))return t;var r=[];for(var s in t)t[s]!=null&&r.push(encodeURIComponent(s)+"="+encodeURIComponent(t[s]));return r.join("&")}w.serializeObject=M;function N(t){for(var r={},s=t.split("&"),h,d,g=0,m=s.length;g<m;++g)d=s[g],h=d.split("="),r[decodeURIComponent(h[0])]=decodeURIComponent(h[1]);return r}w.parseString=N;w.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"};w.serialize={"application/x-www-form-urlencoded":M,"application/json":JSON.stringify};w.parse={"application/x-www-form-urlencoded":N,"application/json":JSON.parse};function Z(t){var r=t.split(/\r?\n/),s={},h,d,g,m;r.pop();for(var v=0,L=r.length;v<L;++v)d=r[v],h=d.indexOf(":"),g=d.slice(0,h).toLowerCase(),m=Y(d.slice(h+1)),s[g]=m;return s}function tt(t){return t.split(/ *; */).shift()}function et(t){return $(t.split(/ *; */),function(r,s){var h=s.split(/ *= */),d=h.shift(),g=h.shift();return d&&g&&(r[d]=g),r},{})}function S(t,r){this.req=t,this.xhr=this.req.xhr,this.text=this.req.method!="HEAD"?this.xhr.responseText:null,this.setStatusProperties(this.xhr.status),this.header=this.headers=Z(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body=this.req.method!="HEAD"?this.parseBody(this.text):null}S.prototype.get=function(t){return this.header[t.toLowerCase()]};S.prototype.setHeaderProperties=function(t){var r=this.header["content-type"]||"";this.type=tt(r);var s=et(r);for(var h in s)this[h]=s[h]};S.prototype.parseBody=function(t){var r=w.parse[this.type];return r&&t&&t.length?r(t):null};S.prototype.setStatusProperties=function(t){var r=t/100|0;this.status=t,this.statusType=r,this.info=r==1,this.ok=r==2,this.clientError=r==4,this.serverError=r==5,this.error=r==4||r==5?this.toError():!1,this.accepted=t==202,this.noContent=t==204||t==1223,this.badRequest=t==400,this.unauthorized=t==401,this.notAcceptable=t==406,this.notFound=t==404,this.forbidden=t==403};S.prototype.toError=function(){var t=this.req,r=t.method,s=t.url,h="cannot "+r+" "+s+" ("+this.status+")",d=new Error(h);return d.status=this.status,d.method=r,d.url=s,d};w.Response=S;function b(t,r){var s=this;U.call(this),this._query=this._query||[],this.method=t,this.url=r,this.header={},this._header={},this.on("end",function(){var h=null,d=null;try{d=new S(s)}catch(g){h=new Error("Parser is unable to parse the response"),h.parse=!0,h.original=g}s.callback(h,d)})}U(b.prototype);b.prototype.use=function(t){return t(this),this};b.prototype.timeout=function(t){return this._timeout=t,this};b.prototype.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this};b.prototype.abort=function(){if(!this.aborted)return this.aborted=!0,this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this};b.prototype.set=function(t,r){if(R(t)){for(var s in t)this.set(s,t[s]);return this}return this._header[t.toLowerCase()]=r,this.header[t]=r,this};b.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this};b.prototype.getHeader=function(t){return this._header[t.toLowerCase()]};b.prototype.type=function(t){return this.set("Content-Type",w.types[t]||t),this};b.prototype.accept=function(t){return this.set("Accept",w.types[t]||t),this};b.prototype.auth=function(t,r){var s=btoa(t+":"+r);return this.set("Authorization","Basic "+s),this};b.prototype.query=function(t){return typeof t!="string"&&(t=M(t)),t&&this._query.push(t),this};b.prototype.field=function(t,r){return this._formData||(this._formData=new FormData),this._formData.append(t,r),this};b.prototype.attach=function(t,r,s){return this._formData||(this._formData=new FormData),this._formData.append(t,r,s),this};b.prototype.send=function(t){var r=R(t),s=this.getHeader("Content-Type");if(r&&R(this._data))for(var h in t)this._data[h]=t[h];else typeof t=="string"?(s||this.type("form"),s=this.getHeader("Content-Type"),s=="application/x-www-form-urlencoded"?this._data=this._data?this._data+"&"+t:t:this._data=(this._data||"")+t):this._data=t;return r?(s||this.type("json"),this):this};b.prototype.callback=function(t,r){var s=this._callback;if(this.clearTimeout(),s.length==2)return s(t,r);if(t)return this.emit("error",t);s(r)};b.prototype.crossDomainError=function(){var t=new Error("Origin is not allowed by Access-Control-Allow-Origin");t.crossDomain=!0,this.callback(t)};b.prototype.timeoutError=function(){var t=this._timeout,r=new Error("timeout of "+t+"ms exceeded");r.timeout=t,this.callback(r)};b.prototype.withCredentials=function(){return this._withCredentials=!0,this};b.prototype.end=function(t){var r=this,s=this.xhr=W(),h=this._query.join("&"),d=this._timeout,g=this._formData||this._data;if(this._callback=t||K,s.onreadystatechange=function(){if(s.readyState==4){if(s.status==0)return r.aborted?r.timeoutError():r.crossDomainError();r.emit("end")}},s.upload&&(s.upload.onprogress=function(L){L.percent=L.loaded/L.total*100,r.emit("progress",L)}),d&&!this._timer&&(this._timer=setTimeout(function(){r.abort()},d)),h&&(h=w.serializeObject(h),this.url+=~this.url.indexOf("?")?"&"+h:"?"+h),s.open(this.method,this.url,!0),this._withCredentials&&(s.withCredentials=!0),this.method!="GET"&&this.method!="HEAD"&&typeof g!="string"&&!V(g)){var m=w.serialize[this.getHeader("Content-Type")];m&&(g=m(g))}for(var v in this.header)this.header[v]!=null&&s.setRequestHeader(v,this.header[v]);return this.emit("request",this),s.send(g),this};w.Request=b;function w(t,r){return typeof r=="function"?new b("GET",t).end(r):arguments.length==1?new b("GET",t):new b(t,r)}w.get=function(t,r,s){var h=w("GET",t);return typeof r=="function"&&(s=r,r=null),r&&h.query(r),s&&h.end(s),h};w.head=function(t,r,s){var h=w("HEAD",t);return typeof r=="function"&&(s=r,r=null),r&&h.send(r),s&&h.end(s),h};w.del=function(t,r){var s=w("DELETE",t);return r&&s.end(r),s};w.patch=function(t,r,s){var h=w("PATCH",t);return typeof r=="function"&&(s=r,r=null),r&&h.send(r),s&&h.end(s),h};w.post=function(t,r,s){var h=w("POST",t);return typeof r=="function"&&(s=r,r=null),r&&h.send(r),s&&h.end(s),h};w.put=function(t,r,s){var h=w("PUT",t);return typeof r=="function"&&(s=r,r=null),r&&h.send(r),s&&h.end(s),h};var rt=w;(function(t){var r,s,h,d,g,m,v,L,i,u,a,l,c,T,E,_,O,q,P,A=[].slice,j={}.hasOwnProperty;i=B,h=i.EventEmitter2||i,T=rt,_=function(n){return typeof n=="string"},E=function(n){return!isNaN(parseFloat(n))},a=function(){var n,e,o,f,p,y,x;for(f=arguments[0],o=2<=arguments.length?A.call(arguments,1):[],y=0,x=o.length;y<x;y++){e=o[y];for(n in e)p=e[n],f[n]=p}return null},q=typeof Buffer<"u"&&Buffer!==null?function(n){return new Buffer(n).toString("base64")}:(L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),O=typeof btoa<"u"&&btoa!==null?btoa:function(n){var e,o,f,p,y,x,C,H,D;for(D=[],H=0;H<n.length;){if(e=n.charCodeAt(H++),o=n.charCodeAt(H++),f=n.charCodeAt(H++),Math.max(e,o,f)>255)throw new Error("Invalid character!");p=e>>2,y=(e&3)<<4|o>>4,x=(o&15)<<2|f>>6,C=f&63,isNaN(o)?x=C=64:isNaN(f)&&(C=64),D.push(L[p]),D.push(L[y]),D.push(L[x]),D.push(L[C])}return D.join("")},function(n){return O(unescape(encodeURIComponent(n)))}),l=function(n){return _(n)?"'"+n+"'":(E(n),n)},c=function(n){return/( asc$| desc$)/i.test(n)?n:n+" asc"},v=function(n,e){var o,f,p,y,x,C;for(C=[],y=0,x=e.length;y<x;y++)o=e[y],_(o)?C.push(n.push(o)):C.push(function(){var H;H=[];for(f in o)p=o[f],H.push(n.push(""+f+" = "+l(p)));return H}());return C},u={and:function(){var n,e;return e=1<=arguments.length?A.call(arguments,0):[],function(){var o,f,p;for(p=[],o=0,f=e.length;o<f;o++)n=e[o],p.push("("+n+")");return p}().join(" and ")},or:function(){var n,e;return e=1<=arguments.length?A.call(arguments,0):[],function(){var o,f,p;for(p=[],o=0,f=e.length;o<f;o++)n=e[o],p.push("("+n+")");return p}().join(" or ")},gt:function(n,e){return""+n+" > "+l(e)},gte:function(n,e){return""+n+" >= "+l(e)},lt:function(n,e){return""+n+" < "+l(e)},lte:function(n,e){return""+n+" <= "+l(e)},eq:function(n,e){return""+n+" = "+l(e)}},P=function(n){var e,o,f;o=[];for(e in n)j.call(n,e)&&(f=n[e],o.push(encodeURIComponent(e)+"="+encodeURIComponent(f)));return o.join("&")},r=function(){function n(e,o){var f;if(this.dataSite=e,this.sodaOpts=o??{},!/^[a-z0-9-_.]+(:[0-9]+)?$/i.test(this.dataSite))throw new Error("dataSite does not appear to be valid! Please supply a domain name, eg data.seattle.gov");this.emitterOpts=(f=this.sodaOpts.emitterOpts)!=null?f:{wildcard:!0,delimiter:".",maxListeners:15},this.networker=function(p,y){var x,C,H=this;return C="https://"+this.dataSite+p.path,x=T(p.method,C),y!=null&&x.set("Accept","application/json"),y!=null&&x.set("Content-type","application/json"),this.sodaOpts.apiToken!=null&&x.set("X-App-Token",this.sodaOpts.apiToken),this.sodaOpts.username!=null&&this.sodaOpts.password!=null&&x.set("Authorization","Basic "+q(""+this.sodaOpts.username+":"+this.sodaOpts.password)),this.sodaOpts.accessToken!=null&&x.set("Authorization","OAuth "+accessToken),p.query!=null&&x.query(p.query),y!=null&&x.send(y),function(D){return x.end(D||H.getDefaultHandler())}}}return n.prototype.getDefaultHandler=function(){var e,o;return this.emitter=e=new h(this.emitterOpts),o=function(f,p){var y;return p.ok?p.accepted?(e.emit("progress",p.body),setTimeout(function(){return this.consumer.networker(opts)(o)},5e3)):e.emit("success",p.body):e.emit("error",(y=p.body)!=null?y:p.text),e.emit("complete",p)}},n}(),s=function(){function n(e,o){this.dataSite=e,this.sodaOpts=o??{},this.connection=new r(this.dataSite,this.sodaOpts)}return n.prototype.query=function(){return new m(this)},n.prototype.getDataset=function(e){return new h(this.emitterOpts)},n}(),g=function(){function n(e,o){this.dataSite=e,this.sodaOpts=o??{},this.connection=new r(this.dataSite,this.sodaOpts)}return n.prototype.operation=function(){return new d(this)},n}(),d=function(){function n(e){this.producer=e}return n.prototype.withDataset=function(e){return this._datasetId=e,this},n.prototype.truncate=function(){var e;return e={method:"delete"},e.path="/resource/"+this._datasetId,this._exec(e)},n.prototype.add=function(e){var o,f,p,y,x;for(f={method:"post"},f.path="/resource/"+this._datasetId,p=JSON.parse(JSON.stringify(e)),delete p[":id"],delete p[":delete"],y=0,x=p.length;y<x;y++)o=p[y],delete o[":id"],delete o[":delete"];return this._exec(f,p)},n.prototype.delete=function(e){var o;return o={method:"delete"},o.path="/resource/"+this._datasetId+"/"+e,this._exec(o)},n.prototype.update=function(e,o){var f;return f={method:"post"},f.path="/resource/"+this._datasetId+"/"+e,this._exec(f,o)},n.prototype.replace=function(e,o){var f;return f={method:"put"},f.path="/resource/"+this._datasetId+"/"+e,this._exec(f,o)},n.prototype.upsert=function(e){var o;return o={method:"post"},o.path="/resource/"+this._datasetId,this._exec(o,e)},n.prototype._exec=function(e,o){if(this._datasetId==null)throw new Error("no dataset given to work against!");return this.producer.connection.networker(e,o)(),this.producer.connection.emitter},n}(),m=function(){function n(e){this.consumer=e,this._select=[],this._where=[],this._group=[],this._having=[],this._order=[],this._offset=this._limit=this._q=null}return n.prototype.withDataset=function(e){return this._datasetId=e,this},n.prototype.soql=function(e){return this._soql=e,this},n.prototype.select=function(){var e,o,f,p;for(o=1<=arguments.length?A.call(arguments,0):[],f=0,p=o.length;f<p;f++)e=o[f],this._select.push(e);return this},n.prototype.where=function(){var e;return e=1<=arguments.length?A.call(arguments,0):[],v(this._where,e),this},n.prototype.having=function(){var e;return e=1<=arguments.length?A.call(arguments,0):[],v(this._having,e),this},n.prototype.group=function(){var e,o,f,p;for(o=1<=arguments.length?A.call(arguments,0):[],f=0,p=o.length;f<p;f++)e=o[f],this._group.push(e);return this},n.prototype.order=function(){var e,o,f,p;for(o=1<=arguments.length?A.call(arguments,0):[],f=0,p=o.length;f<p;f++)e=o[f],this._order.push(c(e));return this},n.prototype.offset=function(e){return this._offset=e,this},n.prototype.limit=function(e){return this._limit=e,this},n.prototype.q=function(e){return this._q=e,this},n.prototype.getOpts=function(){var e,o,f,p;if(o={method:"get"},this._datasetId==null)throw new Error("no dataset given to work against!");o.path="/resource/"+this._datasetId+".json",f=this._buildQueryComponents(),o.query={};for(e in f)p=f[e],o.query["$"+e]=p;return o},n.prototype.getURL=function(){var e,o;return e=this.getOpts(),o=P(e.query),"https://"+this.consumer.dataSite+e.path+(o?"?"+o:"")},n.prototype.getRows=function(){var e;return e=this.getOpts(),this.consumer.connection.networker(e)(),this.consumer.connection.emitter},n.prototype._buildQueryComponents=function(){var e;if(e={},this._soql!=null)e.query=this._soql;else{if(this._select.length>0&&(e.select=this._select.join(", ")),this._where.length>0&&(e.where=u.and.apply(this,this._where)),this._group.length>0&&(e.group=this._group.join(", ")),this._having.length>0){if(!(this._group.length>0))throw new Error("Having provided without group by!");e.having=u.and.apply(this,this._having)}this._order.length>0&&(e.order=this._order.join(", ")),E(this._offset)&&(e.offset=this._offset),E(this._limit)&&(e.limit=this._limit),this._q&&(e.q=this._q)}return e},n}(),a(t!==null?t:F.soda,{Consumer:s,Producer:g,expr:u,_internal:{Connection:r,Query:m,Operation:d,util:{toBase64:q,handleLiteral:l,handleOrder:c}}})})(X);const it=z(X);export{F as c,it as s};
