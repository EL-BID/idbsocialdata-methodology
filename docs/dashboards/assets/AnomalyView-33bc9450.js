import{s as D}from"./soda-js-76022577.js";import{_ as q,r as y,b as h,o as _,c as f,i as p,t as i,e as b,g as n,h as d,j as z,a as e,F as M,d as P,m as j}from"./index-18bc3196.js";const T={methods:{},setup(){var g=y(!1),k=y(0);function x(){fetch("https://mydata.iadb.org/resource/s8uc-zq8r.json").then(a=>a.json()).then(a=>{this.headers=[{title:"País",value:"isoalpha3"},{title:"Año/s",value:"years"},{title:"Indicador",value:"indicator"},{title:"Tema",value:"theme_en"}];var r=a.sort((s,c)=>s.isoalpha3<c.isoalpha3?-1:s.isoalpha3>c.isoalpha3?1:0),t=[];r.forEach(s=>{var c=t.filter(m=>s.indicator==m.indicator&&s.isoalpha3==m.isoalpha3)[0];c!=null&&c?c.years.push(s.year):(s.years=[+s.year],t.push(s))}),this.anomalies=t})}function l(){}function C(a){fetch(`https://mydata.iadb.org/resource/q8e9-eb82.json?$$app_token=IjHG1z0fQXsM9vxlkB8vPq3S2&indicator=${a.indicator}&isoalpha3=${a.isoalpha3}&totals_dummy=1`).then(r=>r.json()).then(r=>{d3.select("#viz").select("svg").remove(),console.clear(),d3.max(r,t=>t.value),new d3plus.LinePlot().data(r).groupBy(["isoalpha3","indicator"]).height(600).x(t=>+t.year).loadingMessage(!0).tooltip(!0).lineMarkerConfig({fill:(t,s)=>+t.y&&z(a.years).indexOf(t.x)>-1||t.value&&z(a.years).indexOf(+t.year)>-1?"#C24E4C":"#1E88E5",label:t=>d3.format(".2f")(t.y),r:20,labelConfig:{fontResize:!0}}).baseline(0).title(`Error encontrado en: <b>${a.isoalpha3} ${a.years.join(", ")} ${a.indicator} ${a.theme_en}</b>`).tooltip(!0).lineMarkers(!0).legend(!1).y(t=>+t.value).select("#viz").render()})}function w(){var a={username:"dcor_key",password:"Elt9d7zx29hqeefy2fv4me9nv"},r=new D.Consumer("mydata.iadb.org",a);console.log(r),r.query().withDataset("5bbz-ibhf").limit(5).getRows().on("success",function(t){console.log(t)}).on("error",function(t){console.error(t)})}return{getData:x,anomalies:k,dialog:g,drawViz:C,connectMyData:w,addException:l}},mounted(){this.getData(),this.connectMyData()}},$={class:"container pt-10"},B={key:0},I=e("b",null,"Total encontradas agrupadas por pais-tema-indicador: ",-1),S={key:1},N=e("b",null,"Países: ",-1),A={key:2},O=e("b",null,"Tema:",-1),R={key:3},F=e("b",null,"Indicadores:",-1),G=e("thead",null,[e("tr",null,[e("th",{class:"bg-blue-darken-1 border border-slate-300 p-1 font-weight-black"}," ID "),e("th",{class:"bg-blue-darken-1 border border-slate-300 p-1 font-weight-black"}," País "),e("th",{class:"bg-blue-darken-1 border border-slate-300 p-1 font-weight-black"}," Tema "),e("th",{class:"bg-blue-darken-1 border border-slate-300 p-1 font-weight-black"}," Indicador "),e("th",{class:"bg-blue-darken-1 border border-slate-300 p-1 font-weight-black"}," Año "),e("th",{class:"bg-blue-darken-1 border border-slate-300 p-1 font-weight-black"}," Acciones ")])],-1),L=e("div",{id:"viz"},null,-1),U=e("div",null,null,-1),H={class:"v-card-text"},Q=e("b",null,"falso positivo",-1);function X(g,k,x,l,C,w){const a=h("v-btn"),r=h("v-spacer"),t=h("v-card-actions"),s=h("v-card"),c=h("v-dialog"),m=h("v-text-field"),E=h("v-table");return _(),f("div",$,[l.anomalies?(_(),f("h4",B,[I,p(" "+i(l.anomalies.length),1)])):b("",!0),l.anomalies?(_(),f("h4",S,[N,p(" "+i([...new Set(l.anomalies.map(o=>o.isoalpha3))].join(", ")),1)])):b("",!0),l.anomalies?(_(),f("h4",A,[O,p(" "+i([...new Set(l.anomalies.map(o=>o.theme_en))].join(", ")),1)])):b("",!0),l.anomalies?(_(),f("h4",R,[F,p(" "+i([...new Set(l.anomalies.map(o=>o.indicator))].join(", ")),1)])):b("",!0),n(E,{density:"compact",class:"pt-10"},{default:d(()=>[G,e("tbody",null,[(_(!0),f(M,null,P(l.anomalies,(o,V)=>(_(),f("tr",{key:o.id},[e("td",null,i(V+1),1),e("td",null,i(o.isoalpha3),1),e("td",null,i(o.theme_en),1),e("td",null,i(o.indicator),1),e("td",null,i(o.years.join(", ")),1),e("td",null,[n(c,{fullscreen:""},{activator:d(({props:u})=>[n(a,j({variant:"outlined",size:"x-small"},u,{text:"Tendencia",onClick:v=>l.drawViz(o)}),null,16,["onClick"])]),default:d(({isActive:u})=>[n(s,{title:""},{default:d(()=>[L,U,n(t,null,{default:d(()=>[n(r),n(a,{text:"Cerrar",onClick:v=>u.value=!1},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024),n(c,null,{activator:d(({props:u})=>[n(a,j({variant:"outlined",size:"x-small"},u,{text:"➕ excepción",class:"ml-2",onClick:v=>l.addException(o)}),null,16,["onClick"])]),default:d(({isActive:u})=>[n(s,{title:""},{default:d(()=>[e("div",H,[e("h3",null,[p("El siguiente registro "),e("b",null,i(o.isoalpha3)+" "+i(o.indicator)+" "+i(o.years.join(", ")),1),p(" se considerará como "),Q,p(" por los motivos que se detallarán a continuación: ")]),n(m,{rows:"3",variant:"outlined",class:"pt-2",modelValue:o.comments,"onUpdate:modelValue":v=>o.comments=v},null,8,["modelValue","onUpdate:modelValue"])]),n(t,null,{default:d(()=>[n(r),n(a,{text:"Cerrar",onClick:v=>u.value=!1},null,8,["onClick"]),n(a,{text:"Guardar",onClick:v=>u.value=!1},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])]))),128))])]),_:1})])}const W=q(T,[["render",X]]);export{W as default};
