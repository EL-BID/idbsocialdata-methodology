import{_ as M,r as f,w as B,b as d,o as v,c as q,g as t,h as l,f as S,e as V,j as b,t as u,a as r,F as E,d as P,m as T}from"./index-955c35c0.js";const F={props:{id:{default:"",type:String}},setup(j){const s=f([]),z=f([]),e=f(!1),p=f([]),A=f(null),m=f([]),h=f([]),g=f(""),w=f("Todos");var y=f([]);B(g,i=>{i&&i.indicator&&D(i.indicator,e)}),B(()=>j.id,i=>{var c=k(i);C(c)});function k(i){let c="";return i=="encuestas"&&(c='collection like "%25Survey%25"'),i=="censos"&&(c='collection like "%25Censuses%25"'),i=="web"&&(c='collection not like "%25Censuses%25" AND collection not like "%25Surveys%25"'),i=="all"?"https://mydata.iadb.org/resource/5bbz-ibhf.json":`https://mydata.iadb.org/resource/5bbz-ibhf.json?$where=${c}`}function x(){d3.selectAll("#search svg").remove(),d3.selectAll(".d3plus-Message").remove()}function C(i){g.value="",y.value=[],w.value="Todos",x(),fetch(i).then(c=>c.json()).then(c=>{z.value=[...new Set(c.map(a=>a.theme_es))],z.value.unshift("Todos"),s.value=[...new Set(c.map(a=>({indicator:a.indicator,name_es:a.label_es,name_en:a.label_en,theme_en:a.theme_en,theme_es:a.theme_es,description_es:a.description_es,description_en:a.description_en,collection:a.collection})))].sort(function(a,o){return a.indicator.localeCompare(o.indicator)})})}var N=(i,c)=>{c&&(p.value=[]),console.log(p._rawValue);var a=`https://mydata.iadb.org/resource/q8e9-eb82.json?$$app_token=IjHG1z0fQXsM9vxlkB8vPq3S2&indicator=${i.indicator}&$limit=8000000&totals_dummy=1`;p._rawValue.length>0&&(a="https://mydata.iadb.org/resource/q8e9-eb82.json?$$app_token=IjHG1z0fQXsM9vxlkB8vPq3S2&$limit=8000000&$where=(",p._rawValue.forEach((o,_)=>{a+=`isoalpha3='${o}'`,_<p._rawValue.length-1&&(a+="OR ")}),a+=`)&indicator=${i.indicator}&totals_dummy=1`),console.log(a),fetch(a).then(o=>o.json()).then(o=>{console.log(o),d3plus.colorDefaults.missing="white",d3plus.colorDefaults.scale.range(["#201923","#ffffff","#fcff5d","#7dfc00","#0ec434","#228c68","#8ad8e8","#235b54","#29bdab","#3998f5","#37294f","#277da7","#3750db","#f22020","#991919","#ffcba5","#e68f66","#c56133","#96341c","#632819","#ffc413","#f47a22","#2f2aa0","#b732cc","#772b9d","#f07cab","#d30b94","#edeff3","#c3a5b4","#946aa2","#5d4c86"]),d3.select("#viz").select("svg").remove();var _=["",...new Set(o.map(n=>n.isoalpha3))];_.length>10&&(h.value=_),new d3plus.LinePlot().data(o.filter(n=>n.management=="Total"&&n.funding=="Total"&&n.idgeo=="country")).groupBy(["isoalpha3"]).height(450).x(n=>+n.year).legend(!1).discrete("x").lineLabels(!0).loadingMessage(!0).tooltip(!0).lineMarkers(!0).legend(!0).legendPosition("bottom").y(n=>parseFloat(n.value)).select("#viz").render()})};function D(i,c){x(),i!=""&&i!=null?fetch(`https://mydata.iadb.org/resource/q8e9-eb82.json?$$app_token=IjHG1z0fQXsM9vxlkB8vPq3S2&$limit=8000000&indicator=${i}`).then(a=>a.json()).then(a=>{d3plus.colorDefaults.missing="white";var o=Array.from(d3.group(a,n=>n.isoalpha3)).length,_=["quintile","education_level","ethnicity","disability","area","age","funding","migration","management","sex"];y.value=[],_.forEach(n=>{a.filter(I=>I[n]!="Total").length>0&&y.value.push(n)}),console.log(a),new d3plus.Matrix().data(a.filter(n=>n.totals_dummy==1)).groupBy(["isoalpha3","year"]).row(n=>n.isoalpha3).column(n=>+n.year).columnConfig({shapeConfig:{labelConfig:{fontResize:!1}}}).rowConfig({shapeConfig:{labelConfig:{fontResize:!1}}}).colorScaleConfig({color:["#60a5fa"]}).colorScale("indicator").legend(!0).height(o*30).select("#search").render(),d3.selectAll(".d3plus-Shape").on("click",n=>{var I=n.srcElement.__data__.data;c.value=!0,A.value=I})}):alert("NO HAY INFORMACIÓN")}return{getData:C,desagregacion_aplicada:y,themes:z,indicators:s,indicator_selected:g,theme_selected:w,defineSource:k,visible:e,item:A,drawViz:N,test:m,countries:h,country:p}},mounted(){let j=this.$route.params.id;var s=this.defineSource(j);this.getData(s)}},O={id:"search"},L=r("p",{class:"text-3xl font-semibold text-black mb-2 lg:mb-0"},"DISPONIBILIDAD",-1),H=r("p",{class:"text-md mb-2 lg:mb-0 text-black"},"Se muestra la disponibilidad de los indicadores socioeconómicos para 26 países de América Latina y el Caribe por país y año, así como la descripción, fuente y desagregaciones de los mismos.",-1),R=["href"],U=["href"],G=r("b",null,"Identificador:",-1),Q=r("b",null,"Nombre (ES):",-1),J=r("b",null,"Nombre (EN):",-1),X=r("b",null,"Descripcion (ES):",-1),Y=r("b",null,"Descripcion (EN):",-1),K=r("b",null,"Fuente:",-1),W=r("p",{class:"pb-2"},[r("b",null,"Desagregaciones")],-1),Z=r("div",{id:"viz",class:"mt-5"},null,-1),$=r("p",null,"* Al hacer click sobre alguno de los recuadros azules (pais-año), se podrá acceder a la descarga de los datos en formato CSV o JSON.",-1),ee=r("div",{id:"search",class:"matrix-indicator px-10"},null,-1);function te(j,s,z,e,p,A){const m=d("v-col"),h=d("v-row"),g=d("v-card-subtitle"),w=d("v-card-item"),y=d("v-spacer"),k=d("v-btn"),x=d("v-card-actions"),C=d("v-card"),N=d("v-dialog"),D=d("v-autocomplete"),i=d("v-chip"),c=d("v-list-item"),a=d("v-select");return v(),q("div",O,[t(h,{class:""},{default:l(()=>[t(m,null,{default:l(()=>[L,H]),_:1})]),_:1}),t(N,{modelValue:e.visible,"onUpdate:modelValue":s[1]||(s[1]=o=>e.visible=o),width:"auto"},{default:l(()=>[t(C,{title:"Descargas de datos"},{default:l(()=>[t(w,null,{default:l(()=>[t(g,null,{default:l(()=>[b("Formato JSON")]),_:1}),e.item?(v(),q("a",{key:0,href:`https://mydata.iadb.org/resource/q8e9-eb82.json?isoalpha3=${e.item.isoalpha3}&indicator=${e.item.indicator}&year=${e.item.year}`,target:"_blank"},"https://mydata.iadb.org/resource/q8e9-eb82.json?isoalpha3="+u(e.item.isoalpha3)+"&indicator="+u(e.item.indicator)+"&year="+u(e.item.year),9,R)):V("",!0)]),_:1}),t(w,null,{default:l(()=>[t(g,null,{default:l(()=>[b("Formato CSV")]),_:1}),e.item?(v(),q("a",{key:0,href:`https://mydata.iadb.org/resource/q8e9-eb82.csv?isoalpha3=${e.item.isoalpha3}&indicator=${e.item.indicator}&year=${e.item.year}`,target:"_blank"},"https://mydata.iadb.org/resource/q8e9-eb82.csv?isoalpha3="+u(e.item.isoalpha3)+"&indicator="+u(e.item.indicator)+"&year="+u(e.item.year),9,U)):V("",!0)]),_:1}),t(x,null,{default:l(()=>[t(y),t(k,{text:"Cerrar",onClick:s[0]||(s[0]=o=>e.visible=!1)})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(h,{class:""},{default:l(()=>[t(m,{cols:"6"},{default:l(()=>[e.themes?(v(),S(D,{key:0,variant:"outlined",class:"text-black",density:"compact",clearable:"",modelValue:e.theme_selected,"onUpdate:modelValue":s[2]||(s[2]=o=>e.theme_selected=o),items:e.themes,label:"Tema"},null,8,["modelValue","items"])):V("",!0)]),_:1}),t(m,{cols:"6"},{default:l(()=>[e.indicators!=0?(v(),S(D,{key:0,variant:"outlined",class:"text-black",density:"compact",clearable:"",modelValue:e.indicator_selected,"onUpdate:modelValue":s[3]||(s[3]=o=>e.indicator_selected=o),"return-object":"",items:e.indicators.filter(o=>e.theme_selected!="Todos"?o.theme_es==e.theme_selected:o),"item-value":"indicator","item-title":"name_es",label:"Indicador"},null,8,["modelValue","items"])):V("",!0)]),_:1})]),_:1}),e.indicator_selected&&e.indicator_selected.indicator?(v(),S(h,{key:0,class:""},{default:l(()=>[t(m,{cols:"8"},{default:l(()=>[r("p",null,[G,b(" "+u(e.indicator_selected.indicator),1)]),r("p",null,[Q,b(" "+u(e.indicator_selected.name_es),1)]),r("p",null,[J,b(" "+u(e.indicator_selected.name_en),1)]),r("p",null,[X,b(" "+u(e.indicator_selected.description_es),1)]),r("p",null,[Y,b(" "+u(e.indicator_selected.description_en),1)]),r("p",null,[K,b(" "+u(e.indicator_selected.collection),1)])]),_:1}),t(m,{cols:"4"},{default:l(()=>[W,(v(!0),q(E,null,P(e.desagregacion_aplicada,o=>(v(),S(i,null,{default:l(()=>[b(u(o),1)]),_:2},1024))),256))]),_:1})]),_:1})):V("",!0),t(h),e.indicator_selected&&e.indicator_selected.indicator?(v(),S(h,{key:1},{default:l(()=>[t(m,{cols:"12"},{default:l(()=>[t(N,{fullscreen:""},{activator:l(({props:o})=>[t(k,T({variant:"outlined",class:"text-black",size:"x-small"},o,{text:"Tendencia",onClick:s[4]||(s[4]=_=>e.drawViz(e.indicator_selected,!0))}),null,16)]),default:l(({isActive:o})=>[t(C,{title:""},{default:l(()=>[t(g,null,{default:l(()=>[t(a,{modelValue:e.country,"onUpdate:modelValue":s[6]||(s[6]=_=>e.country=_),items:e.countries,label:"Pais",variant:"outlined",multiple:""},{item:l(({props:_,item:n})=>[t(c,T(_,{onClick:s[5]||(s[5]=I=>e.drawViz(e.indicator_selected,!1))}),null,16)]),_:1},8,["modelValue","items"])]),_:1}),Z,t(x,null,{default:l(()=>[t(y),t(k,{text:"Cerrar",onClick:_=>o.value=!1},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1}),t(m,{cols:"12"},{default:l(()=>[$]),_:1})]),_:1})):V("",!0),t(h,null,{default:l(()=>[t(m,{cols:"12"},{default:l(()=>[ee]),_:1})]),_:1})])}const oe=M(F,[["render",te]]);export{oe as default};
